/*! Copyright 2023 Jason Go - Apache-2.0 */
"use strict";(()=>{var se=Object.create;var B=Object.defineProperty;var de=Object.getOwnPropertyDescriptor;var pe=Object.getOwnPropertyNames;var me=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty;var fe=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var he=(e,o,n,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let p of pe(o))!ue.call(e,p)&&p!==n&&B(e,p,{get:()=>o[p],enumerable:!(c=de(o,p))||c.enumerable});return e};var ye=(e,o,n)=>(n=e!=null?se(me(e)):{},he(o||!e||!e.__esModule?B(n,"default",{value:e,enumerable:!0}):n,e));var U=fe(u=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});u.sanitizeUrl=u.BLANK_URL=void 0;var _e=/^([^\w]*)(javascript|data|vbscript)/im,ve=/&#(\w+)(^\w|;)?/g,ge=/&(newline|tab);/gi,q=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Se=/^.+(:|&colon;)/gim,we=[".","/"];u.BLANK_URL="about:blank";function be(e){return we.indexOf(e[0])>-1}function xe(e){var o=e.replace(q,"");return o.replace(ve,function(n,c){return String.fromCharCode(c)})}function ke(e){if(!e)return u.BLANK_URL;var o=xe(e).replace(ge,"").replace(q,"").trim();if(!o)return u.BLANK_URL;if(be(o))return o;var n=o.match(Se);if(!n)return o;var c=n[0];return _e.test(c)?u.BLANK_URL:o}u.sanitizeUrl=ke});var z=(e,o=12e4,n=[],c=[])=>{let p=setTimeout(()=>{v=()=>{}},o),v=()=>{document.readyState.length>7&&n.every(l=>Object.hasOwn(window,l))&&c.every(l=>document.querySelector(l))?(clearInterval(p),e()):setTimeout(v,9)};v()},d=e=>document.querySelector(e);var T=e=>{var o,n;return e.address={postal_code:d("#checkout_offer_extra_contact_information_address_zip").value,city:d("#checkout_offer_extra_contact_information_address_city").value,country:d("#input-address-country").value,line1:d("#checkout_offer_extra_contact_information_address_line_1").value,line2:d("#checkout_offer_extra_contact_information_address_line_2").value===""?d("#checkout_offer_extra_contact_information_address_line_1").value:d("#checkout_offer_extra_contact_information_address_line_2").value,state:(n=d("#checkout_offer_extra_contact_information_address_state"))==null?void 0:n.options[(o=d("#checkout_offer_extra_contact_information_address_state"))==null?void 0:o.selectedIndex].text},e};var D=ye(U(),1),W=()=>{/*! ========== KAJABI CODE STARTS HERE. COPYRIGHT BY KAJABI. ALL RIGHTS RESERVED. ========== *//*! Derived from https://kajabi-app-assets.kajabi-cdn.com/assets/checkout_manifest-beb59d57b2efd87b9ac8ac1f00432d86319f381c8387ca1af95d65307682494a.js */window.App.StripeElementsForm=function(e,o,n){function c(){var t={stripeAccount:n.stripeAccount,apiVersion:n.apiVersion};return l()&&(t.betas=["elements_enable_deferred_intent_beta_1"]),t}function p(){if(l()){var t={theme:"stripe",variables:{borderRadius:"4px",colorPrimary:n.checkoutPageColor,colorDanger:r.colorDanger,colorTextPlaceholder:r.placeholderColor,colorIcon:r.placeholderColor,fontSizeBase:r.fontSize,fontFamily:'-apple-system, "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "Noto Sans", sans-serif',fontSmooth:"always",fontLineHeight:r.lineHeight},rules:{".Label":{fontWeight:"500",marginBottom:"8px"},".TabLabel":{fontWeight:"500"},".Input":{fontWeight:"400",borderColor:"#C7CFD8",boxShadow:"none",color:"#556370",padding:"6px 12px"},".Input::placeholder":{fontWeight:"400",fontFamily:'-apple-system, "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "Noto Sans", sans-serif',letterSpacing:"0px",boxShadow:"none",color:"#748493"},".Input--invalid":{fontWeight:"400",fontFamily:'-apple-system, "BlinkMacSystemFont", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "Noto Sans", sans-serif',letterSpacing:"0px",boxShadow:"none",borderColor:"#C7CFD8",color:"#556370"},".Error":{fontSize:"12px"}}};return{mode:"payment",paymentMethodTypes:x(),externalPaymentMethodTypes:n.acceptsPaypal&&S?["external_paypal"]:[],amount:Math.max(r.amount,50),currency:r.currency.toLowerCase(),appearance:t,locale:n.locale,fonts:[{cssSrc:"https://fonts.googleapis.com/css?family=Open+Sans:400,400i"},{family:"Circular",src:"url(https://sage.kajabi-cdn.com/fonts/circular/CircularXXWeb-Regular.woff2?v=1)",weight:"400"},{family:"Circular",src:"url(https://sage.kajabi-cdn.com/fonts/circular/CircularXXWeb-Bold.woff2?v=1)",weight:"700"}]}}return{locale:n.locale,fonts:[{cssSrc:"https://fonts.googleapis.com/css?family=Open+Sans:400,400i"}]}}function v(){return l()?"#payment-element":"#card-element"}function l(){return n.mode==="payment"||S}function x(){return S?n.additionalPaymentMethods.concat(["card"]):["card"]}function f(t){_.toggleClass(ie,t)}function G(){!N&&le&&M&&(N=!0,ktag("event","add_payment_info",M))}function I(){e.attr("data-return-to")&&window.location.replace((0,D.sanitizeUrl)(e.attr("data-return-to")))}function y(t){if(h.length){var a=$(h).find("input[type='checkbox']");h.hide()}if(t.error)f(!0),Q(t),E(t),I();else if(t.setupIntent){f(!1);var i=t.setupIntent.payment_method;r.paymentMethodField.val(i),e[0].submit()}else if(t.paymentMethod){f(!1);var i=t.paymentMethod;r.paymentMethodField.val(i.id),l()&&(window.currentSelection!=="external_paypal"&&$("#checkout_offer_payment_method_type").val(i.type),window.currentSelection!=="card"&&$("#checkout_offer_consent_to_store_payment_method").val(0)),e[0].submit()}else t.complete&&window.currentSelection==="card"&&(f(!1),ne(a),h.show(),G(event))}function g(t,a){if(t.error)t.error.type==="invalid_request_error"&&t.error.code==="payment_intent_authentication_failure"?a?L():te():y(t);else if(t.paymentIntent){f(!1);var i=t.paymentIntent.id;r.paymentIntentField.val(i),e[0].submit()}else y(t)}function Q(t){window.App.flashError({text:t.error.message}),setTimeout(function(){$.rails.enableFormElements(e)},100)}function E(t){var a;e.find("input.email")[0]&&(a=e.find("input.email").val());var i={stripe_elements_error_report:{email:a,stripe_result:t}};$.post("/stripe_elements_error_reports.json",i)}function Z(t){t.brand!==O&&(_.trigger("card-brand-change",t.brand),O=t.brand)}function A(t,a){t.confirmation_method==="manual"?s.handleCardAction(b).then(function(i){g(i,a)}):s.handleCardPayment(b).then(function(i){g(i,a)})}function F(t,a){s.retrievePaymentIntent(t).then(function(i){i.paymentIntent&&i.paymentIntent.status==="requires_action"?A(i.paymentIntent,a):i.paymentIntent&&i.paymentIntent.status==="requires_confirmation"?L():y(i)})}function Y(){window.ApplePaySession&&x().indexOf("apple_pay")>=0&&ee()}function ee(){var t=CLIENT_INFO.offer_token;t&&$.ajax({type:"POST",url:"/offers/"+t+"/checkout/verify_apple_pay_domain",data:{domain:window.location.host}}).done(function(a){a.verified===!0&&e.attr("data-kp-ap-verified",!0)})}function L(){$.ajax({url:e.attr("action"),method:"POST",dataType:"json",data:e.serialize()}).done(function(t){t.paymentIntent&&t.paymentIntent.status==="requires_action"?A(t.paymentIntent,!1):g(t,!1)})}function te(){$.ajax({url:e.attr("action").replace("confirm","cancel"),method:"POST",dataType:"json",data:e.serialize()}).done(function(t){t.paymentIntent&&t.paymentIntent.status==="canceled"?I():g(t,!1)})}function ne(t){h.length&&t.prop("checked",re)}function oe(){var t={hidePostalCode:ce,iconStyle:"solid",style:{base:{iconColor:r.placeholderColor,color:r.color,lineHeight:r.lineHeight,fontSize:r.fontSize,fontFamily:'"Open Sans", sans-serif',fontWeight:"normal",fontSmoothing:"antialiased","::placeholder":{fontFamily:'"Open Sans", sans-serif',color:r.placeholderColor,iconColor:r.placeholderColor}},invalid:{color:r.colorDanger,iconColor:r.colorDanger}}};return w.create("card",t)}function R(t){E({readyState:document.readyState,elementType:l()?"payment":"card",error:t,stripeJsVersion:s&&s.version,analyticsOptions:M,paymentMethods:x(),additionalPaymentMethods:n.additionalPaymentMethods,stripeAccount:n.stripeAccount,stripeTimeoutPromptEnabled:n.stripeElementTimeoutPrompt})}function ae(){var t=w.create("payment",{layout:{type:S?"accordion":"tabs",defaultCollapsed:!0,radios:!0,spacedAccordionItems:!1},business:{name:n.siteName},fields:{billingDetails:{email:"never"}},wallets:{googlePay:n.additionalPaymentMethods&&n.additionalPaymentMethods.indexOf("google_pay")>=0?"auto":"never",applePay:n.additionalPaymentMethods&&n.additionalPaymentMethods.indexOf("apple_pay")>=0?"auto":"never"}});return t.on("change",function(a){window.currentSelection,a.value.type,window.currentSelection=a.value.type,$(document).trigger(window.currentSelection==="external_paypal"?"kjb:checkout:paypalSelected":"kjb:checkout:otherSelected"),h.hide()}),t}this.$eventBus=$(document);var r=$.extend({color:"#151515",colorDanger:"#e2422d",fontSize:"14px",paymentMethodField:e.find("[data-stripe-payment-method]").first(),paymentIntentField:e.find("[data-stripe-payment-intent]").first(),lineHeight:"36px",placeholderColor:"#999999"},n);this.$opts=r;var S=n.additionalPaymentMethods&&n.additionalPaymentMethods.length>0,H=v(),_=$(H),h=$("#manage_payment_method"),k=$("#checkout_offer_offer_price_override"),re=h.prop("checked"),ie="card-element-has-error",s=typeof Stripe=="undefined"?null:Stripe(o,c()),w=s&&s.elements(p());this.$elements=w;var m,O,le=document.querySelector(".offer-checkout--analytics")!==null,M=n.analyticsOptions,ce=r.hidePostalCode==="true",N=!1;if(window.currentSelection="card",this.$completionRequired=!1,s||R({code:"stripe_js_not_loaded",message:"Stripe JS was loaded not at time of elements form initialization"}),_.length){n.stripeElementTimeoutPrompt&&e.find("input.btn").attr("disabled",!0),setTimeout(function(){window.stripeReady||(R({code:"initialization_timeout",message:"Did not receive ready from element within expected time"}),n.stripeElementTimeoutPrompt&&window.App.flashError({text:n.stripeElementTimeoutPromptMessage}))},1e4);var m=l()?ae():oe();if(m.mount(H),l()&&Y(),document.querySelector(".offer-checkout--preview")!==null&&document.querySelector(".offer-checkout-next-gen")!==null)return;m.on("ready",function(){e.find("input.btn").attr("disabled",!1),window.stripeReady=!0}),m.on("change",function(a){_.trigger("card-change",a),y(a),Z(a)}),_.on("card-reset",function(){f(!1),m.clear(),m.focus()}),_.on("card-error",function(){f(!0)})}if(k.length&&l()&&k.on("change keyup paste",function(){var t=Number($(k).val()),a=Math.floor(Math.max(t*Math.pow(10,n.exponent),50));w.update({amount:a})}),l()&&(this.$eventBus.on("kjb:checkout:coupon:applied",this.onCouponApplied.bind(this)),this.$eventBus.on("kjb:checkout:coupon:removed",this.onCouponRemoved.bind(this)),this.$eventBus.on("kjb:checkoutPaymentStepComplete",this.onPaymentStepComplete.bind(this)),this.$eventBus.on("kjb:checkoutPaymentStepIncomplete",this.onPaymentStepIncomplete.bind(this))),e.on("submit",function(t){if((!l()||this.$completionRequired)&&!(window.kjbStripeElementSkip||window.currentSelection==="external_paypal"||window.giftCouponApplied||window.freePwyw)){t.preventDefault(),$.rails.disableFormElements(e);var a={};e.find('input[data-stripe="name"]')[0]&&(a.name=e.find('input[data-stripe="name"]').val()),e.find('input[data-stripe="address_zip"]')[0]&&(a.address={postal_code:e.find('input[data-stripe="address_zip"]').val()}),a.email=e.find('input[type="email"]').val(),n.intent?s.handleCardSetup(n.intent,m,{payment_method_data:{billing_details:T(a)}}).then(y):m?s.createPaymentMethod("card",m,{billing_details:T(a)}).then(y):e[0].submit()}}.bind(this)),e.attr("data-payment-intent-client-secret")){var b=e.attr("data-payment-intent-client-secret"),j=e.attr("data-reconfirmable")==="true";e.attr("data-automatic-confirmation")&&F(b,j),$("[data-confirm-stripe-payment-intent]").on("click",function(){event.preventDefault(),F(b,j)})}},window.App.StripeElementsForm.bindTo=function(e){var o=$(e),n=o.closest("form"),c=JSON.parse(o.attr("data-stripe-elements-options")||"{}");new window.App.StripeElementsForm(n,o.attr("data-stripe-elements-form"),c)},window.App.StripeElementsForm.prototype={onCouponApplied:function(e,o){this.$elements.update({amount:Math.max(o.due_now_price,50)})},onCouponRemoved:function(){this.$elements.update({amount:Math.max(this.$opts.amount,50)})},onPaymentStepComplete:function(){this.$completionRequired=!1},onPaymentStepIncomplete:function(){this.$completionRequired=!0,window.currentSelection==="external_paypal"&&$(document).trigger("kjb:checkout:paypalSelected")}},$(function(){$("[data-stripe-elements-form]").each(function(e,o){window.App.StripeElementsForm.bindTo(o)})});/*! ========== KAJABI CODE ENDS HERE. COPYRIGHT BY KAJABI. ALL RIGHTS RESERVED. ========== */};var K,C=Object.assign({enabledOffers:"",disabledOffers:""},(K=document.currentScript)==null?void 0:K.dataset),X,J,P=(J=(X=window.location.href.match(/\/offers\/(.{8})/))==null?void 0:X[1])!=null?J:"",V=()=>{P===""||C.disabledOffers.split(/\s*[,|]\s*/).includes(P)||C.enabledOffers!==""&&!C.enabledOffers.split(/\s*[,|]\s*/).includes(P)||z(W,1e4,["$","App","Stripe"],["#checkout_offer_extra_contact_information_address_zip"])};V();})();
//# sourceMappingURL=saba.min.js.map
